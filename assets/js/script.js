function SeriesService($http){function getSeries(page){return page?request=pagedAPI:(request=API,page=""),$http.get(request+page).then(function(response){var totalPages=response.headers("X-WP-TotalPages");return processSeriesList(response.data,totalPages)})}function getSerie(id){return $http.get(API+"/"+id).then(function(response){var totalPosts=response.headers("X-WP-Total");return processSerie(response.data,totalPosts)})}function getSerieBySlug(slug){return $http.get(API+"?filter[name]="+slug).then(function(response){var totalPosts=response.headers("X-WP-Total");return processSerie(response.data[0],totalPosts)})}function processSerie(item,totalPosts){var processedItem;return processedItem={id:item.id,date:item.date,link:item.link,title:item.title.rendered,slug:item.slug,content:item.content.rendered,image:item.featured_media,totalPosts:totalPosts}}function processSeriesList(data,totalPages){return data.map(function(item){var processedItem;return processedItem={id:item.id,date:item.date,link:item.link,title:item.title.rendered,slug:item.slug,content:item.content.rendered,image:item.featured_media,totalPages:totalPages}})}function getImageThumbnail(id){return $http.get(API+"/"+id).then(function(response){return response.data.better_featured_image.media_details.sizes.thumbnail.source_url})}var API="wp-json/wp/v2/series",pagedAPI="wp-json/wp/v2/series?page=",request="";return{getSeries:getSeries,getSerie:getSerie,getSerieBySlug:getSerieBySlug,getImageThumbnail:getImageThumbnail}}function OmdbService($http){function getImage(query){var cleanedQuery=query.split(" ").join("+");return $http.get(API+cleanedQuery).then(function(response){return response.data.Poster})}function getYear(query){var cleanedQuery=query.split(" ").join("+");return $http.get(API+cleanedQuery).then(function(response){return response.data.Year})}function getActors(query){var cleanedQuery=query.split(" ").join("+");return $http.get(API+cleanedQuery).then(function(response){return response.data.Actors})}function getRating(query){var cleanedQuery=query.split(" ").join("+");return $http.get(API+cleanedQuery).then(function(response){return response.data.imdbRating})}var API="https://www.omdbapi.com/?t=";return{getImage:getImage,getYear:getYear,getActors:getActors,getRating:getRating}}function MediaService($http){function getMediaItem(id){return $http.get(API+"/"+id).then(function(response){return processMediaItem(response.data)})}function processMediaItem(item){var processedItem;if(item.media_details.sizes){var mediaBase=item.media_details.sizes;if(mediaBase.thumbnail)var thumbnailImage=mediaBase.thumbnail.source_url;if(mediaBase.medium)var mediumImage=mediaBase.medium.source_url;if(mediaBase.medium_large)var mediumLargeImage=mediaBase.medium_large.source_url;if(mediaBase.large)var largeImage=mediaBase.large.source_url}return processedItem={id:item.id,date:item.date,link:item.link,title:item.title.rendered,alt:item.alt_text,slug:item.slug,type:item.media_type,sizes:{thumbnail:thumbnailImage,medium:mediumImage,mediumLarge:mediumLargeImage,large:largeImage}}}var API="wp-json/wp/v2/media";return{getMediaItem:getMediaItem}}function PagesService($http){function getPage(slug){return $http.get(API+"?slug="+slug).then(function(response){return response.data[0]})}var API="wp-json/wp/v2/pages";return{getPage:getPage}}angular.module("app",["home","detail","about"]),angular.module("home",["ngSanitize","ui.router","infinite-scroll"]);var home={bindings:{list:"<"},templateUrl:"wp-content/themes/wcbcn/assets/js/components/home/home.component.html",controller:function(SeriesService){var ctrl=this,currentPage=2,pageLimit=5;ctrl.busy=!1,ctrl.activeItem=0,ctrl.loadMorePages=function(){currentPage<=pageLimit&&(ctrl.busy=!0,SeriesService.getSeries(currentPage).then(function(response){currentPage++,pageLimit=response[0].totalPages,ctrl.list=ctrl.list.concat(response),ctrl.busy=!1}))}}};angular.module("home").component("home",home).config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode(!0),$stateProvider.state("home",{url:"/",component:"home",resolve:{list:function(SeriesService){return SeriesService.getSeries()}}}),$urlRouterProvider.otherwise("/")});var listItem={bindings:{item:"<",activeItem:"="},controller:function(){var ctrl=this;ctrl.selectItem=function(item){ctrl.activeItem&&ctrl.activeItem===item?ctrl.activeItem=0:ctrl.activeItem=item}},templateUrl:"wp-content/themes/wcbcn/assets/js/components/home/list-item/list-item.component.html"};angular.module("home").component("listItem",listItem);var thumbnail={bindings:{omdbQuery:"<",featuredImageId:"<"},controller:function(OmdbService,MediaService){var ctrl=this;ctrl.image="",ctrl.featuredImageId?MediaService&&MediaService.getMediaItem(ctrl.featuredImageId).then(function(response){ctrl.image=response.sizes.thumbnail}):OmdbService.getImage(ctrl.omdbQuery).then(function(response){ctrl.image=response})},templateUrl:"wp-content/themes/wcbcn/assets/js/components/home/list-item/thumbnail/thumbnail.component.html"};angular.module("home").component("thumbnail",thumbnail);var actors={bindings:{omdbQuery:"<"},controller:function(OmdbService){var ctrl=this;ctrl.actors="",OmdbService.getActors(ctrl.omdbQuery).then(function(response){ctrl.actors=response})},templateUrl:"wp-content/themes/wcbcn/assets/js/components/home/list-item/actors/actors.component.html"};angular.module("home").component("actors",actors);var rating={bindings:{omdbQuery:"<"},controller:function(OmdbService){function round(value,step){step||(step=1);var inv=1/step;return Math.round(value*inv)/inv}var ctrl=this;ctrl.stars="",OmdbService.getRating(ctrl.omdbQuery).then(function(response){ctrl.stars=response,ctrl.rating={value:response,stars:round(response/10*5,.5)}})},templateUrl:"wp-content/themes/wcbcn/assets/js/components/home/list-item/rating/rating.component.html"};angular.module("home").component("rating",rating),angular.module("detail",["ngSanitize","ui.router"]);var detail={bindings:{serie:"<"},controller:function($state){},templateUrl:"wp-content/themes/wcbcn/assets/js/components/detail/detail.component.html"};angular.module("detail").component("detail",detail).config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode(!0),$stateProvider.state("detail",{url:"/series/:slug",component:"detail",params:{slug:null},resolve:{serie:function(SeriesService,$transition$){var params=$transition$.params().slug;return console.log(params),SeriesService.getSerieBySlug(params)}}}),$urlRouterProvider.otherwise("/")}),angular.module("about",["ngSanitize"]);var about={bindings:{pageContent:"<"},templateUrl:"wp-content/themes/wcbcn/assets/js/components/about/about.component.html",controller:function(){}};angular.module("about").component("about",about).config(function($stateProvider,$urlRouterProvider,$locationProvider){$locationProvider.html5Mode(!0),$stateProvider.state("about",{url:"/sobre-esta-web/",component:"about",resolve:{pageContent:function(PagesService){return PagesService.getPage("sobre-esta-web")}}}),$urlRouterProvider.otherwise("/")}),angular.module("app").factory("SeriesService",SeriesService),angular.module("app").factory("OmdbService",OmdbService),angular.module("app").factory("MediaService",MediaService),angular.module("app").factory("PagesService",PagesService);
//# sourceMappingURL=script.js.map
